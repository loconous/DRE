const execVulnerability = require('../../shared/vulnerability/vulnerability');
const vulnerabilityValidateMiddleware = require('../../middlewares/vulnerabilityValidate');
const { validationResult } = require('express-validator');
const { getBlobData } = require('../../shared/vulnerability/blobs');

module.exports = (app) => {
    app.get('/api/vulnerability', vulnerabilityValidateMiddleware, vulnerability);
}

module.exports = (app) => {
    app.get('/api/vulnerability', (req, res, next) => {
        //Send back test data
        console.log("Request received.");
        res.status(200).json({name: "Test data", value: "12312313123"});
    });
    app.post('/api/vulnerability', async (req, res) => {
        console.log("Post request received.");
        console.log("Request data: ", req.body);
        let bl = await getBlobData(req.body.name);           
        console.log("blob list in api route:", bl);
        // getBlobData(req.body.name).then(bl => {
        //     console.log("blob list in api route:", bl);
        // });
        res.status(200).json({success: true, value: "POST request works!"});
    });
}